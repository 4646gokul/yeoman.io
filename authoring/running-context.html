<!DOCTYPE html><html lang=en data-version=6f5ee67><head><meta charset=utf-8><title>Generator Runtime Context | Yeoman</title><meta name=viewport content="width=device-width"><link rel=icon type=image/x-icon href=/static/favicon.b25e58c4b8.ico><meta name=google-site-verification content=fBQRJ6h7MV7_TJ7grbgq4P-d-07NRfDWPe4pqEEoH5w><link href="//fonts.googleapis.com/css?family=Roboto+Slab:400,700%7CRoboto:400,700,700italic,400italic" rel=stylesheet><link rel=stylesheet href=/static/bundle-5594.4dbe0c3199.css><link href=/blog/atom.xml type=application/atom+xml rel=alternate title="Yeoman Blog Atom Feed"></head><body class=documentation><header class=page-header><div class=container><div class=mobile-bar><h1 class=logo><a href="/"><img src=/static/logo.2a54d87108.png alt=Yeoman></a></h1><button class="mobile-menu-toggle ir">open</button></div><nav class=main-menu><ul class=main-nav><li><a href="/learning/">Using Yeoman</a><ul> <li><a href=/learning/index.html>Getting started</a></li> <li><a href=/codelab/index.html>Tutorial (codelab)</a></li> <li><a href=/learning/resources.html>Resources</a></li> <li><a href=/learning/deployment.html>Deployment</a></li> <li><a href=/learning/faq.html>FAQ</a></li> <li><a href=/learning/support.html>Support</a></li></ul></li><li><a href="/generators/">Discovering generators</a></li> <li><a href=/authoring/ class=active>Creating a generator</a><ul> <li><a href=/authoring/index.html>Getting started</a></li> <li><a href=/authoring/running-context.html class=active>Running Context</a></li> <li><a href=/authoring/user-interactions.html>User Interactions</a></li> <li><a href=/authoring/composability.html>Composability</a></li> <li><a href=/authoring/dependencies.html>Managing Dependencies</a></li> <li><a href=/authoring/file-system.html>Interacting with the file system</a></li> <li><a href=/authoring/gruntfile.html>Creating a Gruntfile</a></li> <li><a href=/authoring/storage.html>Storing user configs</a></li> <li><a href=/authoring/testing.html>Unit testing</a></li> <li><a href=/authoring/debugging.html>Debugging Generators</a></li> <li><a href=/authoring/integrating-yeoman.html>Integrating Yeoman in other tools</a></li> <li><a href="http://yeoman.io/generator/">Full API documentation</a></li></ul></li><li><a href="/blog/">Blog</a></li> <li><a href="/contributing/">Contributing</a><ul> <li><a href=/contributing/index.html>Contributing</a></li> <li><a href=/contributing/opening-issues.html>How to open an issue</a></li> <li><a href=/contributing/pull-request.html>How to submit a PR</a></li> <li><a href=/contributing/style-guide.html>Style Guide</a></li> <li><a href=/contributing/testing-guidelines.html>Testing Guidelines</a></li> <li><a href=/contributing/ticketing.html>Issue system overview</a></li></ul></li></ul></nav></div></header><div class=SiteWrapper><div id=content><h2 class=page-title><span class=container>Generator Runtime Context</span></h2><div class="container clearfix has-sidebar"><nav class=context-nav><ul><li><a href=/authoring/index.html>Getting started</a></li> <li><a href=/authoring/running-context.html class=active>Running Context</a></li> <li><a href=/authoring/user-interactions.html>User Interactions</a></li> <li><a href=/authoring/composability.html>Composability</a></li> <li><a href=/authoring/dependencies.html>Managing Dependencies</a></li> <li><a href=/authoring/file-system.html>Interacting with the file system</a></li> <li><a href=/authoring/gruntfile.html>Creating a Gruntfile</a></li> <li><a href=/authoring/storage.html>Storing user configs</a></li> <li><a href=/authoring/testing.html>Unit testing</a></li> <li><a href=/authoring/debugging.html>Debugging Generators</a></li> <li><a href=/authoring/integrating-yeoman.html>Integrating Yeoman in other tools</a></li> <li><a href="http://yeoman.io/generator/">Full API documentation</a></li></ul></nav><article class=main><section class=content-chunk><p>One of the most important concepts to grasp when writing a Generator is how methods are run and in which context.</p><h2>Prototype methods as actions</h2><p>Each method directly attached to a Generator prototype is considered to be a task. Each task is run in sequence by the Yeoman environment run loop.</p><p>In other words, each functions on the object returned by <code>Object.getPrototypeOf(Generator)</code> will be automatically run.</p><h3>Helper and private methods</h3><p>Now that you know the prototype methods are considered to be task, you may wonder how to define helper or private methods that won't be called automatically. There are three different ways to achieve this.</p><ol><li>Prefix method name by an underscore (e.g. <code>_private_method</code>).</li> <li><p>Use instance methods:</p><div class=highlight><pre><code class=language-js data-lang=js>  <span class=nx>generators</span><span class=p>.</span><span class=nx>Base</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
    <span class=nx>constructor</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>helperMethod</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'won\'t be called automatically'</span><span class=p>);</span>
      <span class=p>};</span>
    <span class=p>}</span>
  <span class=p>});</span>
</code></pre></div></li><li><p>Extend a parent generator</p><div class=highlight><pre><code class=language-js data-lang=js>  <span class=kd>var</span> <span class=nx>MyBase</span> <span class=o>=</span> <span class=nx>generators</span><span class=p>.</span><span class=nx>Base</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
    <span class=nx>helper</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'methods on the parent generator won\'t be called automatically'</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>});</span>

  <span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=nx>MyBase</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
    <span class=nx>exec</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
      <span class=k>this</span><span class=p>.</span><span class=nx>helper</span><span class=p>();</span>
    <span class=p>}</span>
  <span class=p>});</span>
</code></pre></div></li></ol><h2>The run loop</h2><p>Running tasks sequentially is alright if there's a single generator. But it is not enough once you start composing generators together.</p><p>That's why Yeoman uses a <strong>run loop</strong>.</p><p>The run loop is a queue system with priority support. We use the <a href=https://github.com/SBoudrias/grouped-queue>Grouped-queue</a> module to handle the run loop.</p><p>Priorities are defined in your code as special prototype method names. When a method name is the same as a priority name, the run loop pushes the method into this special queue. If the method name doesn't match a priority, it is pushed in the <code>default</code> group.</p><p>In code, it will look this way:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>generators</span><span class=p>.</span><span class=nx>Base</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
  <span class=nx>priorityName</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{}</span>
<span class=p>});</span>
</code></pre></div><p>You can also group multiple methods to be run together in a queue by using a hash instead of a single method:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>generators</span><span class=p>.</span><span class=nx>Base</span><span class=p>.</span><span class=nx>extend</span><span class=p>({</span>
  <span class=nx>priorityName</span><span class=o>:</span> <span class=p>{</span>
    <span class=nx>method</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{},</span>
    <span class=nx>method2</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{}</span>
  <span class=p>}</span>
<span class=p>});</span>
</code></pre></div><p>The available priorities are (in running order):</p><ol><li><code>initializing</code> - Your initialization methods (checking current project state, getting configs, etc)</li> <li><code>prompting</code> - Where you prompt users for options (where you'd call <code>this.prompt()</code>)</li> <li><code>configuring</code> - Saving configurations and configure the project (creating <code>.editorconfig</code> files and other metadata files)</li> <li><code>default</code> - If the method name doesn't match a priority, it will be pushed to this group.</li> <li><code>writing</code> - Where you write the generator specific files (routes, controllers, etc)</li> <li><code>conflicts</code> - Where conflicts are handled (used internally)</li> <li><code>install</code> - Where installation are run (npm, bower)</li> <li><code>end</code> - Called last, cleanup, say <em>good bye</em>, etc</li></ol><p>Follow these priorities guidelines and your generator will play nice with others.</p><h1>Asynchronous tasks</h1><p>There's multiples way to pause the run loop until a task is done doing work asynchronously.</p><p>The easiest way is to <strong>return a promise</strong>. The loop will continue once the promise resolve, or it'll raise an exception and stop if it fails.</p><p>If the asynchronous API you're relying upon doesn't support promise, then you can rely on the legacy <code>this.async()</code> way. Calling <code>this.async()</code> will return a function to call once the task is done. For example:</p><div class=highlight><pre><code class=language-js data-lang=js><span class=nx>asyncTask</span><span class=o>:</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>done</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>async</span><span class=p>();</span>

  <span class=nx>getUserEmail</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>done</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
  <span class=p>});</span>
<span class=p>}</span>
</code></pre></div><p>If the <code>done</code> function is called with an error parameter, the run loop will stop and an exception will be raised.</p><div class=contribute-doc>Found a typo? An unclear example? Help us improve our documentation by forking and sending your fixes and suggestions. <a href=https://github.com/yeoman/yeoman.github.io/blob/source/app/authoring/running-context.md>Improve this Page!</a></div></section></article></div></div><footer class=SiteFooter><div class=SiteFooter-donation><div class=Donation><div class=Donation-sticker-clipping><img src=/static/yeoman-character-sticker.51cef7e007.png class=Donation-sticker width=190 height=294 alt=Stickers!></div><div class=Donation-text><a href=https://www.stickermule.com/user/1070704235/stickers>Show your love for <strong>Yeoman</strong>,<br> wear our <strong>sticker</strong>!</a></div></div></div><ul class=SiteFooter-links><li><a href=https://plus.google.com/101063139999404044459/posts class=icon><img src=/static/social-gplus.cdac08228d.svg class=SiteFooter-icon alt=Google+></a></li> <li><a href=https://twitter.com/yeoman class=icon><img src=/static/social-twitter.5b4b6063b9.svg class=SiteFooter-icon alt=Twitter></a></li> <li><a href=https://github.com/yeoman/yeoman class=icon><img src=/static/social-github.767995ad17.svg class=SiteFooter-icon alt=Github></a></li> <li><a href=/blog/atom.xml class=icon><img src=/static/social-feed.c635057faf.svg class=SiteFooter-icon alt=Feed></a></li> <li class=mobile-ln></li> <li><a href=http://yeoman.io/generator/ class="SiteFooter-button SiteFooter-button--light">API</a></li> <li><a href=https://github.com/yeoman/yeoman.github.io/blob/source/app/authoring/running-context.md class=SiteFooter-button title="Edit this page on Github to help improve the site">Improve this page</a></li></ul></footer><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js></script><script src=/static/bundle-5659.dd18c65bd5.js async></script><script>!function(n,t,e){'undefined'!=typeof e.module&&e.module.exports?e.module.exports=t():'undefined'!=typeof e.define&&'function'==e.define&&e.define.amd?define(n,t):e[n]=t()}('$script',function(){function n(n,t){for(var e=0,o=n.length;o>e;++e)if(!t(n[e]))return l;return 1}function t(t,e){n(t,function(n){return!e(n)})}function e(r,c,l){function p(n){return n.call?n():u[n]}function g(){if(!--j){u[y]=1,v&&v();for(var e in s)n(e.split('|'),p)&&!t(s[e],p)&&(s[e]=[])}}r=r[m]?r:[r];var h=c&&c.call,v=h?c:l,y=h?r.join(''):c,j=r.length;return setTimeout(function(){t(r,function(n){return d[n]?(y&&(f[y]=1),2==d[n]&&g()):(d[n]=1,y&&(f[y]=1),o(!a.test(n)&&i?i+n+'.js':n,g),void 0)})},0),e}function o(n,t){var e=r.createElement('script'),o=l;e.onload=e.onerror=e[v]=function(){e[g]&&!/^c|loade/.test(e[g])||o||(e.onload=e[v]=null,o=1,d[n]=2,t())},e.async=1,e.src=n,c.insertBefore(e,c.firstChild)}var i,r=document,c=r.getElementsByTagName('head')[0],a=/^https?:\/\//,u={},f={},s={},d={},l=!1,m='push',p='DOMContentLoaded',g='readyState',h='addEventListener',v='onreadystatechange';return!r[g]&&r[h]&&(r[h](p,function y(){r.removeEventListener(p,y,l),r[g]='complete'},l),r[g]='loading'),e.get=o,e.order=function(n,t,o){!function i(r){r=n.shift(),n.length?e(r,i):e(r,t,o)}()},e.path=function(n){i=n},e.ready=function(o,i,r){o=o[m]?o:[o];var c=[];return!t(o,function(n){u[n]||c[m](n)})&&n(o,function(n){return u[n]})?i():!function(n){s[n]=s[n]||[],s[n][m](i),r&&r(c)}(o.join('|')),e},e},this);var _gaq=[['_setAccount','UA-32956520-1'],['_setDomainName','.yeoman.io'],['_trackPageview'],['_trackPageLoadTime']];$script('http://www.google-analytics.com/ga.js'),$script('https://apis.google.com/js/plusone.js'),$script('//platform.twitter.com/widgets.js')//# sourceMappingURL=../static/yeoman-5739.3d3928805d.map</script></div></body></html>